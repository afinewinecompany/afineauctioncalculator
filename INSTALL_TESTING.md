# Quick Start: Testing Framework Installation

## Step 1: Install Dependencies

Run this command in your project root:

```bash
npm install -D vitest @vitest/ui @testing-library/react @testing-library/jest-dom @testing-library/user-event jsdom @vitest/coverage-v8 supertest @types/supertest
```

This installs:
- `vitest` - Fast test runner
- `@vitest/ui` - Web UI for tests
- `@testing-library/*` - React testing utilities
- `jsdom` - Browser environment for tests
- `@vitest/coverage-v8` - Code coverage
- `supertest` - API testing (for future integration tests)

## Step 2: Verify Installation

Check that the test scripts are in `package.json`:

```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "test:ui": "vitest --ui"
  }
}
```

## Step 3: Run Tests

### First Test Run

```bash
npm run test:unit
```

This runs all tests once and shows results in the terminal.

### Expected Output

```
✓ server/services/__tests__/valueCalculator.test.ts (45 tests)
✓ server/services/__tests__/inflationCalculator.test.ts (52 tests)
✓ server/services/__tests__/playerMatcher.test.ts (53 tests)

Test Files  3 passed (3)
Tests  150 passed (150)
Duration  2.5s
```

## Step 4: Check Coverage

```bash
npm run test:coverage
```

This generates a coverage report and ensures all business logic meets the 80% threshold.

View the HTML report:
```bash
open coverage/index.html    # macOS
start coverage/index.html   # Windows
xdg-open coverage/index.html # Linux
```

## Step 5: Development Workflow

### Watch Mode (Recommended)

```bash
npm run test:watch
```

This runs tests automatically when you save files. Perfect for TDD (test-driven development).

### Interactive UI

```bash
npm run test:ui
```

Opens a web interface at http://localhost:51204 with:
- Visual test results
- File-by-file breakdown
- Test execution timeline
- Coverage visualization

## File Structure

After installation, you should have:

```
afineauctioncalculator/
├── vitest.config.ts                           # Vitest configuration
├── TESTING_SETUP.md                           # Detailed documentation
├── INSTALL_TESTING.md                         # This file
├── src/
│   └── test/
│       └── setup.ts                           # Frontend test setup
├── server/
│   ├── test/
│   │   └── setup.ts                           # Backend test setup
│   └── services/
│       └── __tests__/
│           ├── valueCalculator.test.ts        # 45 tests
│           ├── inflationCalculator.test.ts    # 52 tests
│           └── playerMatcher.test.ts          # 53 tests
└── coverage/                                  # Generated by test:coverage
    ├── index.html
    └── lcov.info
```

## Troubleshooting

### "Cannot find module" errors

```bash
# Clear node_modules and reinstall
rm -rf node_modules package-lock.json
npm install
```

### Tests not running

```bash
# Verify Vitest is installed
npx vitest --version

# Run with debug output
npx vitest run --reporter=verbose
```

### Coverage thresholds failing

The tests require 80% coverage. If coverage is too low:

1. Check which files are uncovered:
   ```bash
   npm run test:coverage
   ```

2. View the HTML report to see specific lines missing coverage

3. Add tests for uncovered code paths

## What Tests Cover

### Value Calculator (45 tests)
- SGP-based auction value calculation
- Points-based scoring
- Tier assignments (1-10)
- Market inflation adjustments
- Budget distribution
- Category validation
- Edge cases

### Inflation Calculator (52 tests)
- Tier-weighted inflation
- Positional scarcity analysis
- Team budget constraints
- Historical inflation baselines
- Forward-looking adjustments
- Edge cases (deflation, extreme values)

### Player Matcher (53 tests)
- Name normalization (diacritics, suffixes)
- Exact matching (mlbamId, name+team)
- Fuzzy matching algorithms
- Position/team disambiguation
- Confidence scoring
- Batch processing
- Edge cases

## Next Commands

```bash
# Run only one test file
npx vitest run server/services/__tests__/valueCalculator.test.ts

# Run tests matching a pattern
npx vitest run -t "SGP"

# Update snapshots (if using snapshot testing)
npx vitest run -u

# Run with specific reporter
npx vitest run --reporter=json --outputFile=test-results.json
```

## CI/CD Integration

For GitHub Actions, the workflow is already configured in `.github/workflows/test.yml`:

```yaml
- run: npm ci
- run: npm run test:coverage
```

Coverage reports can be sent to Codecov or similar services.

## Need Help?

- Read `TESTING_SETUP.md` for detailed documentation
- Check `vitest.config.ts` for configuration details
- Look at existing tests for examples
- Visit https://vitest.dev/ for Vitest docs

---

**Status**: Ready for use
**Test Count**: 150 unit tests
**Coverage**: 80%+ on business logic
**Phase**: 3.1 Complete
